name: create new UNITY app
on:
  workflow_dispatch:
    inputs:
      appYaml:
        description: yaml spec of the app to create
        required: true
        type: string
  issues:
    types:
      - labeled

jobs:
  create-app:
    runs-on: atc-ubuntu-latest
    timeout-minutes: 10
    permissions: write-all
    concurrency:
      group: ${{ github.event.issue.id }}
    steps:
      - uses: actions/checkout@v3
      - name: build-actions
        uses: ./.github/actions/build-actions
      - name: create-app
        uses: ./.github/actions/create-app/
        with:
          GITHUB_TOKEN: ${{secrets.UNITY_BOT_TOKEN}}
          appYaml: ${{ inputs.appYaml }}
